%Results from SNP_BUR_DOM_CHES_wDOC_9
snp_temp=[26.13  24.51  21.70  24.96  18.37  23.97  27.76  25.07  27.65  27.13  9.021  26.62 ...
    12.87  24.52  12.59  12.92  9.354  24.68  22.71  24.88  23.05  27.72  25.54  17.29  23.11  ...
    9.387  12.59  24.56  25.24  26.34  18.96  20.27  10.76  11.86  13.84  27.00  18.71  28.65]';
snp_salt=[ 12.83  16.40  5.657  19.99  28.94  25.97  13.38  13.20  8.290  6.530  16.60  19.65  11.86  8.590 ...
    21.37  15.65  16.83  19.66  10.60  12.51  8.549  20.11  17.28  30.90  5.949  13.17  21.37  17.14  16.48 ...
    20.52  13.12  23.09  19.26  19.28  1.393  16.12  17.25  14.7]';
snp_alk=[1528.   1680.   1271.   1809.   2132.   2023.   1569.   1581.   1365.   1341.   1693.   1789.   1518.   1508.   1879.   1670.   1705.   1786.   1472.   1510.   1412.   1803.   1717.   2197.   1256.   1539.   1879.   1689.   1660.   1828.   1525.   1921.   1806.   1808.   976.9   1673.   1692.   1605]';
snp_tic=[1584.  1557.  1164.  1658.  1939.  1856.  1468.  1514.  1281.  1276.  1719.  1800.  1373.  1391.  1741.  1543.  1699.  1789.  1360.  1705.  1256.  1648.  1611.  2053.  1090.  1594.  1741.  1785.  1513.  1737.  1710.  1803.  1734.  1702.  988.2  1762.  1771.  1487.]';
snp_DO=[78.84  238.2  282.7  232.2  223.8  201.6  225.3  218.0  232.2  210.4  174.2  66.13  342.4  262.5  297.3  310.1  201.3  55.74  228.9  8.947  263.1  220.8  220.8  177.4  273.4  177.1  297.4  5.922  241.2  162.9  7.368  183.7  255.1  275.8  349.3  36.69  21.07  224.0]';
snp_nh4=[10.87  0.1607  4.064  0.1938  2.340  3.375  0.2726  1.772  0.1986  3.045  14.27  11.65  0.9792  2.074  0.8396  0.6337  12.48  13.88  3.905  15.60  0.5145  0.1519  2.022  3.662  0.5084  15.46  0.8403  12.17  0.1357  6.178  17.77  8.170  7.222  4.732  2.117  11.16  16.80  0.357]';
snp_no3=[-4.082E-10  0.002390  3.033  0.001827  3.361E-04  0.001673  0.002108  0.03757  8.481E-04  3.891E-07  4.822  5.009E-05  2.617  0.5035  0.001271  0.01926  3.420 -2.871E-10  0.01922 -1.343E-09  0.005306  0.001668  0.005459  9.897E-04  0.002674  10.86  0.001272 -4.310E-10  0.001339  0.01620  0.07969  1.146E-04  0.4618  0.1159  42.46  4.636E-04  1.015E-05  0.00142]';
snp_h2s=[0.005715  9.978E-04  0.007664  0.001105  0.001233  0.001571  0.001244  0.001753  0.002269  0.02244  0.001421  0.003827  4.086E-04  0.003373  6.762E-04  6.847E-04  0.001345  0.006219  0.001441  0.4906  0.001269  0.001078  0.001497  0.001690  0.001430  8.266E-04  6.764E-04  0.06377  0.001207  0.002216  0.3278  0.002069  0.001189  0.001028  9.608E-05  0.01518  0.01484  0.001659]';
snp_po4=[ 2.795  1.759  1.493  1.448  0.4246  1.358  1.379  2.517  2.062  2.080  1.279  2.602  0.2995  2.198  0.01192  0.06992  1.054  2.159  1.141  3.767  0.9380  0.9856  1.862  0.9797  1.063  1.727  0.01195  2.872  0.6528  1.856  3.305  0.9056  0.4444  0.2853  2.461  3.389  2.274  1.237]';
snp_no2=[10.80  10.63  8.943  9.976  6.109  8.897  12.69  10.09  9.682  8.432  12.28  13.42  8.704  8.248  5.502  7.282  11.06  13.61  13.20  3.739  13.48  10.47  11.21  8.520  11.98  13.00  5.502  9.950  10.11  10.68  5.623  8.252  7.198  6.406  2.534  9.866  15.31  11.89]';
snp_chl=[ 7.124   7.809   28.19   6.963   4.970   5.108   10.71   12.26   15.65   25.75  0.9277   3.171   9.923   26.58   1.276   4.173   1.506   2.854   11.93   4.308   15.37   7.791   10.04   7.419   16.21   1.534   1.277   2.705   7.788   5.301   2.776   3.345   1.163   1.755   10.07   4.857   1.945   10.77]';
[snp_pco2 snp_co3 snp_hco3 snp_co2aq snp_PH]=pco2calc_b(snp_tic*1e-6,snp_alk*1e-6,snp_temp,snp_salt);
snp_PH=snp_PH';

snp_phyto=[ 5.292   7.830   19.14   7.583   4.703   4.965   10.19   9.913   12.94   17.75  0.8722   2.564   10.62   17.49   5.253   6.886   1.539   2.470   9.406   3.043   12.35   8.504   8.525   5.171   13.03   1.253   5.255   2.177   8.529   4.794   1.912   3.033   2.202   3.435   8.072   3.585   1.494   10.4]';
snp_dop=[ 0.4554  0.2769  0.7810  0.2553  0.3408  0.2318  0.4075  0.3385  0.5943  0.7708  0.6030  0.2226  0.7163  0.6558  0.5092  0.6314  0.6057  0.3556  0.6844  0.4767  0.7337  0.3325  0.2716  0.3041  0.7818  0.6252  0.5091  0.3633  0.5097  0.2392  0.6639  0.4386  0.5339  0.5452  0.3957  0.2706  0.5647  0.3968]';
snp_sdon=[ 7.272   4.259   14.05   3.958   5.236   3.596   6.343   5.233   9.317   12.53   11.10   3.581   12.40   10.71   8.573   10.71   10.90   5.705   10.90   7.913   11.72   5.138   4.265   4.684   12.74   12.15   8.572   5.900   7.911   3.783   11.57   6.908   9.328   9.298   10.75   4.386   9.362   6.151]';
snp_rdon=[10.47   9.974   11.02   9.442   9.515   8.486   10.18   10.77   10.96   11.42   9.883   9.602   10.06   11.69   9.622   9.949   9.880   9.831   10.13   10.49   10.22   9.666   9.881   8.782   10.64   9.966   9.622   10.03   9.896   9.388   10.16   9.747   9.717   9.727   9.785   10.29   9.935   10.06]';

snp_pprod=[0.02802   1.449   20.76   1.002  0.1477  0.2487   2.598   7.144   3.039   18.22  8.872E-07  4.292E-06   7.663   15.52   1.310   2.719  2.811E-09  6.898E-07   1.055  3.685E-07   5.537   1.200   7.005  0.03380   4.668  3.488E-06   1.267  2.663E-06   1.314  6.822E-06  4.793E-08  0.02267  3.629E-08  0.04591   6.931  1.106E-05  8.828E-09   2.602]';
%snp_no3uptake=[ 0.0000  0.0000  0.007353  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.02376  0.0000  0.002676  5.487E-04  0.0000  0.0000  0.01277  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.04240  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.02226  0.0000  0.0000  0.0000]';
snp_no3uptake=[2.876E-17  0.009726   3.864  0.005840  1.958E-06  2.220E-05  0.008805  0.4319  0.001440  4.236E-07  2.692E-08  7.732E-12   4.122   3.219  0.001847  0.07825  9.506E-11  9.171E-21  0.002297  0.0000  0.04713  0.004738  0.009948  2.458E-06  0.01428  1.042E-07  0.001750  0.0000  0.004002  1.964E-08  1.755E-10  2.165E-08  1.140E-09  8.322E-04   1.537  3.283E-10  6.581E-18  0.00254]';
%snp_nitri1=[0.3177  0.003579  0.05113  0.004710  0.05164  0.06898  0.005805  0.03904  0.004151  0.06189  0.7072  0.5599  0.01946  0.03637  0.01252  0.01194  0.6243  0.6624  0.08337  0.5781  0.007680  0.003563  0.03722  0.09268  0.01094  0.7626  0.01261  0.4236  0.003365  0.3029  0.6385  0.2371  0.3638  0.1407  0.03456  0.5205  0.7473  0.007781]';
snp_nitri1=[0.3186  0.003593  0.05120  0.004745  0.05055  0.06980  0.005805  0.03910  0.004155  0.06186  0.7031  0.5610  0.01684  0.03635  0.01333  0.008742  0.6164  0.6633  0.08317  0.5788  0.007671  0.003589  0.03741  0.09860  0.01094  0.7620  0.01340  0.4277  0.003357  0.3045  0.6406  0.2347  0.3575  0.1181  0.03424  0.5203  0.7496  0.007803]';
%snp_nitri2=[ 0.02821  0.01411  0.01121  0.01276  0.01131  0.01840  0.01615  0.01328  0.01284  0.01054  0.06138  0.06497  0.01141  0.01050  0.006398  0.009526  0.05552  0.06556  0.02135  0.01438  0.01714  0.01320  0.01461  0.02105  0.01536  0.06530  0.006421  0.03480  0.01281  0.05296  0.02121  0.02235  0.03514  0.01687  0.003799  0.04659  0.06875  0.01499]';
snp_nitri2=[0.02815  0.01403  0.01105  0.01266  0.01078  0.01826  0.01603  0.01320  0.01277  0.01048  0.06054  0.06462  0.01107  0.01045  0.006751  0.009401  0.05464  0.06507  0.02115  0.01428  0.01703  0.01303  0.01452  0.02101  0.01523  0.06409  0.006771  0.03503  0.01263  0.05261  0.02056  0.02168  0.03564  0.01533  0.003736  0.04606  0.06828  0.0148]';
snp_dno2=[ 0.01085  0.002238  0.003826  0.002130  0.002069  0.004006  0.002996  0.002970  0.003001  0.006167  0.01134  0.01737  0.001357  0.003741  8.199E-04  0.001142  0.008688  0.02272  0.004232  0.04432  0.003118  0.002242  0.003070  0.005881  0.003157  0.009863  8.220E-04  0.1889  0.002597  0.006568  0.1512  0.005056  0.002406  0.001799  1.989E-04  0.03103  0.07127  0.003988]';
%snp_dno3=[ 0.0000  0.0000  0.007353  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.02376  0.0000  0.002676  5.487E-04  0.0000  0.0000  0.01277  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.04240  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.02226  0.0000  0.0000  0.0000]';
snp_dno3=[ 0.0000  0.0000  0.007106  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.02717  0.0000  0.002242  5.259E-04  0.0000  0.0000  0.01565  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.04370  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.0000  0.02234  0.0000  0.0000  0.0000];
%snp_srra=[0.003631  7.532E-04  0.001024  7.615E-04  0.001304  0.001603  8.587E-04  0.001052  0.001104  0.002634  0.001928  0.004734  3.734E-04  0.001585  6.056E-04  5.684E-04  0.001977  0.006250  0.001173  0.09380  8.477E-04  7.658E-04  9.816E-04  0.002422  9.506E-04  8.495E-04  6.073E-04  0.08365  9.202E-04  0.002192  0.1416  0.002232  0.001252  0.001052  6.714E-05  0.01148  0.01829  0.001212]';
snp_srra=[0.003629  7.547E-04  0.001041  7.645E-04  0.001289  0.001614  8.586E-04  0.001053  0.001105  0.002638  0.001705  0.004792  4.040E-04  0.001588  5.940E-04  5.756E-04  0.001755  0.006196  0.001173  0.09439  8.484E-04  7.683E-04  9.836E-04  0.002487  9.511E-04  8.014E-04  5.956E-04  0.08189  9.178E-04  0.002204  0.1452  0.002209  0.001226  0.001057  6.740E-05  0.01156  0.01820  0.001212]';
%snp_sox_O=[ 0.005277  9.224E-04  0.006777  0.001019  0.001156  0.001445  0.001153  0.001619  0.002096  0.02058  0.001496  0.003467  3.591E-04  0.003113  6.475E-04  6.306E-04  0.001423  0.005749  0.001335  0.3780  0.001175  9.941E-04  0.001382  0.001521  0.001322  8.146E-04  6.476E-04  0.05085  0.001123  0.002038  0.2455  0.001935  0.001132  9.566E-04  8.947E-05  0.01352  0.01323  0.001536]';
snp_sox_O=[0.005251  9.245E-04  0.007097  0.001024  0.001143  0.001455  0.001153  0.001624  0.002102  0.02078  0.001315  0.003508  3.792E-04  0.003127  6.272E-04  6.351E-04  0.001246  0.005681  0.001335  0.3823  0.001176  9.982E-04  0.001386  0.001564  0.001325  7.649E-04  6.273E-04  0.05045  0.001119  0.002050  0.2568  0.001915  0.001102  9.533E-04  8.912E-05  0.01369  0.01317  0.001537]';
%snp_sox_no3=[1.951E-25  3.022E-09  1.316E-05  2.988E-09  7.858E-10  4.052E-09  4.149E-09  8.812E-08  2.571E-09  3.310E-25  5.226E-06  3.086E-09  5.197E-07  1.543E-06  6.364E-10  1.680E-08  3.605E-06  2.476E-25  4.232E-08  2.467E-22  8.411E-09  2.703E-09  1.142E-08  3.432E-09  4.724E-09  3.657E-06  6.367E-10  3.048E-23  2.024E-09  7.160E-08  5.603E-04  6.746E-10  3.787E-07  5.759E-08  2.399E-07  3.767E-08  5.170E-09  3.569E-09]';
snp_sox_no3=[1.940E-25  2.998E-09  1.358E-05  2.951E-09  6.269E-10  3.881E-09  4.089E-09  8.809E-08  2.531E-09  3.355E-25  4.659E-06  8.012E-10  4.932E-07  1.527E-06  9.711E-10  1.323E-08  3.295E-06  2.425E-25  3.904E-08  2.504E-22  8.030E-09  2.643E-09  1.109E-08  2.802E-09  4.333E-09  3.384E-06  9.721E-10  2.968E-23  1.965E-09  6.828E-08  5.216E-04  3.963E-10  5.759E-07  1.288E-07  2.387E-07  3.469E-08  8.403E-10  3.473E-09]';
%snp_sox_no2=[1.574E-05  8.802E-07  5.876E-06  9.757E-07  9.578E-07  1.522E-06  1.238E-06  1.655E-06  1.988E-06  2.102E-05  2.163E-06  1.274E-05  2.259E-07  2.507E-06  3.623E-07  3.993E-07  1.712E-06  2.709E-05  1.437E-06  0.008787  1.098E-06  1.020E-06  1.447E-06  1.760E-06  1.146E-06  1.157E-06  3.623E-07  0.002017  1.042E-06  2.885E-06  0.007545  2.201E-06  8.888E-07  6.466E-07  2.757E-08  9.530E-05  1.657E-04  1.623E-0]';
snp_sox_no2=[1.562E-05  8.803E-07  6.128E-06  9.774E-07  9.170E-07  1.530E-06  1.234E-06  1.656E-06  1.989E-06  2.119E-05  1.802E-06  1.302E-05  2.336E-07  2.514E-06  3.573E-07  3.982E-07  1.424E-06  2.647E-05  1.433E-06  0.008876  1.098E-06  1.019E-06  1.449E-06  1.838E-06  1.146E-06  1.050E-06  3.572E-07  0.001967  1.033E-06  2.904E-06  0.007878  2.142E-06  8.365E-07  6.334E-07  2.715E-08  9.663E-05  1.637E-04  1.618E-06]';
%snp_par=[0.1309  81.89  46.80  78.81  0.9421  1.463  106.5  63.14  92.04  91.88  2.088E-05  4.472E-05  94.35  72.46  107.6  84.19  2.573E-08  7.161E-06  3.390  3.292E-06  103.8  53.66  68.20  0.1930  95.09  6.100E-05  90.15  3.192E-05  94.63  3.765E-05  6.115E-07  0.1919  1.119E-07  0.1999  78.83  8.014E-05  1.475E-07  90.97]';
snp_par=[ 0.1306  81.86  46.84  78.76  0.9631  1.446  106.5  63.14  92.03  91.91  2.654E-05  4.427E-05  94.99  72.48  109.1  86.93  4.562E-08  7.155E-06  3.410  3.326E-06  103.8  53.63  68.19  0.1870  95.13  6.798E-05  94.16  3.192E-05  94.71  3.662E-05  6.261E-07  0.1948  4.295E-07  0.3777  78.84  8.040E-05  1.527E-07  90.97]';
figure(1);clf
subplot(331)
mnlim=floor(min([TEMP' snp_temp']));
mxlim=ceil(max([TEMP' snp_temp']));
scatter(TEMP,snp_temp,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k')
title('A: Temperature (^\circ C)')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((TEMP-snp_temp).^2)/std(TEMP.^2);
text((mnlim+mxlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])
ylabel('Model Predictions')

subplot(332)
mnlim=floor(min([SALT' snp_salt']*10))/10;
mxlim=ceil(max([SALT' snp_salt']*10))/10;
scatter(SALT,snp_salt,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k')
title('B: Salinity (PSU)')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((SALT-snp_salt).^2)/std(SALT.^2);
text((mnlim+mxlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])

subplot(334)
mnlim=floor(min([DO' snp_DO']));
mxlim=ceil(max([DO' snp_DO']));
scatter(DO,snp_DO2,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('D: Oxygen (\muM)')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((DO-snp_DO2).^2)/std(DO.^2);
text((mnlim+mxlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])

subplot(338)
mnlim=floor(min(([NO3F' snp_no3'])));
mxlim=ceil(max(([NO3F' snp_no3'])));
scatter((NO3F),(snp_no3),40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('H: Nitrate (\mu M)')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean(((NO3F)-(snp_no3)).^2)/std((NO3F).^2);
text((mnlim+mxlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])
ylabel('Model Predictions')
xlabel('Observations')
colorbar('Location',['south'])

subplot(339)
mnlim=floor(min([NO23F' snp_no2'+snp_no3']));
mxlim=ceil(max([NO23F' snp_no2'+snp_no3']));
scatter(NO2F+NO3F,snp_no2+snp_no3,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('I: Nitrate+Nitrite (\mu M)')
xlabel('Observations')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((NO23F-snp_no2-snp_no3).^2)/std(NO23F.^2);
text((mnlim+mxlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])
ylabel('Model Predictions')
%colorbar('Location','north')

subplot(336)
mnlim=floor(min([NH4F' snp_nh4']));
mxlim=ceil(max([NH4F' snp_nh4']));
scatter(NH4F,snp_nh4,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('F: Ammonium (\mu M)')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((NH4F-snp_nh4).^2)/std(NH4F.^2);
text((mnlim+mxlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])


subplot(335)
mnlim=floor(min([PO4F' snp_po4']));
mxlim=ceil(max([PO4F' snp_po4']));
scatter(PO4F,snp_po4,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('E: PO4 (\mu M)')
ylabel('Model Predictions')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((PO4F-snp_po4).^2)/std((PO4F).^2);
text(mnlim+(mxlim-mnlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])

subplot(337)
mnlim=floor(min([PH' snp_PH']));
mxlim=ceil(max([PH' snp_PH']));
scatter(PH,snp_PH,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('G: PH')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((PH-snp_PH).^2)/std(PH.^2);
text(mnlim+(mxlim-mnlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])
xlabel('Observations')

subplot(333)
mnlim=floor(min([CHLA' snp_chl']));
mxlim=ceil(max([CHLA' snp_chl']));
scatter(CHLA,snp_chl,40,Yearday,'filled');hold on;plot([mnlim mxlim],[mnlim mxlim],'k');
title('C: CHLA (mg/m^3)')
axis('square');axis([mnlim mxlim mnlim mxlim])
COD=1-mean((CHLA-snp_chl).^2)/std(CHLA.^2);
text(mnlim+(mxlim-mnlim)*0.4,mnlim+(mxlim-mnlim)/10,['COD=' num2str(COD,'%5.3f')])